{"name": "test_update_user", "status": "failed", "statusDetails": {"message": "AssertionError: Ошибка обновления: {\"error\":\"this phone already exists\"}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code", "trace": "def test_update_user():\n        \"\"\"Обновление данных пользователя с обязательными полями\"\"\"\n        with allure.step(\"Подготовка тестовых данных\"):\n            # Загрузка переменных окружения\n            load_dotenv(ENV_FILE)\n            base_url = os.getenv(\"API_URL\")\n            token = os.getenv(\"TOKEN_ID\")\n            test_user_id = os.getenv(\"CREATED_USER_ID\")\n    \n            # Проверка наличия обязательных переменных\n            assert base_url, \"API_URL не задан в .env\"\n            assert token, \"TOKEN_ID не задан в .env\"\n            assert test_user_id, \"CREATED_USER_ID не задан в .env\"\n    \n        with allure.step(\"1. Получение текущих данных пользователя\"):\n            get_headers = {\"tockenid\": token, \"accept\": \"*/*\"}\n            get_url = f\"{base_url}/api/v1/user/{test_user_id}\"\n    \n            allure.attach(\n                f\"curl -X GET '{get_url}' -H 'accept: */*' -H 'tockenid: {token}'\",\n                name=\"CURL команда для получения данных\",\n                attachment_type=allure.attachment_type.TEXT\n            )\n    \n            get_response = requests.get(get_url, headers=get_headers)\n            allure.attach(\n                f\"Status Code: {get_response.status_code}\\nResponse: {get_response.text}\",\n                name=\"Response Details\",\n                attachment_type=allure.attachment_type.TEXT\n            )\n    \n            assert get_response.status_code == 200, \"Не удалось получить данные пользователя\"\n            current_data = get_response.json()\n            allure.attach(\n                str(current_data),\n                name=\"Текущие данные пользователя\",\n                attachment_type=allure.attachment_type.JSON\n            )\n    \n        with allure.step(\"2. Подготовка данных для обновления\"):\n            update_data = {\n                \"fio\": \"Новое ФИО\",\n                \"login\": current_data[\"login\"],\n                \"mail\": \"updated.email@example.com\",\n                \"phone\": \"79123456789\",\n                \"role_id\": current_data[\"role_id\"],\n                \"tenant_id\": current_data[\"tenant_id\"],\n                \"is_manager\": 1\n            }\n            allure.attach(\n                str(update_data),\n                name=\"Данные для обновления\",\n                attachment_type=allure.attachment_type.JSON\n            )\n    \n        with allure.step(\"3. Отправка запроса на обновление\"):\n            headers = {\n                \"accept\": \"application/json, text/plain, */*\",\n                \"content-type\": \"application/json\",\n                \"tockenid\": token\n            }\n            update_url = f\"{base_url}/api/v1/user/{test_user_id}\"\n    \n            allure.attach(\n                f\"curl -X PUT '{update_url}' -H 'accept: application/json' \"\n                f\"-H 'content-type: application/json' -H 'tockenid: {token}' \"\n                f\"-d '{str(update_data).replace(\"'\", '\"')}'\",\n                name=\"CURL команда для обновления\",\n                attachment_type=allure.attachment_type.TEXT\n            )\n    \n            response = requests.put(update_url, headers=headers, json=update_data)\n            allure.attach(\n                f\"Status Code: {response.status_code}\\nResponse: {response.text}\",\n                name=\"Response Details\",\n                attachment_type=allure.attachment_type.TEXT\n            )\n    \n>           assert response.status_code == 200, f\"Ошибка обновления: {response.text}\"\nE           AssertionError: Ошибка обновления: {\"error\":\"this phone already exists\"}\nE           assert 400 == 200\nE            +  where 400 = <Response [400]>.status_code\n\ntests\\user\\test_user_update.py:89: AssertionError"}, "description": "Обновление данных пользователя с обязательными полями", "steps": [{"name": "Подготовка тестовых данных", "status": "passed", "start": 1752689495090, "stop": 1752689495093}, {"name": "1. Получение текущих данных пользователя", "status": "passed", "attachments": [{"name": "CURL команда для получения данных", "source": "c8957c4a-b4f1-405f-8968-e93295fefa07-attachment.txt", "type": "text/plain"}, {"name": "Response Details", "source": "184ca2fc-60de-4843-97f9-fdb439bd007b-attachment.txt", "type": "text/plain"}, {"name": "Текущие данные пользователя", "source": "525fe066-7f41-4175-9704-d51e174124df-attachment.json", "type": "application/json"}], "start": 1752689495093, "stop": 1752689495415}, {"name": "2. Подготовка данных для обновления", "status": "passed", "attachments": [{"name": "Данные для обновления", "source": "03fbf4ed-dde1-4eee-9d90-3a15c6c8d974-attachment.json", "type": "application/json"}], "start": 1752689495415, "stop": 1752689495416}, {"name": "3. Отправка запроса на обновление", "status": "failed", "statusDetails": {"message": "AssertionError: Ошибка обновления: {\"error\":\"this phone already exists\"}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code\n", "trace": "  File \"C:\\Users\\annal_e209e90\\OneDrive\\Рабочий стол\\test\\corpsoft\\tests\\user\\test_user_update.py\", line 89, in test_update_user\n    assert response.status_code == 200, f\"Ошибка обновления: {response.text}\"\n"}, "attachments": [{"name": "CURL команда для обновления", "source": "2ac641a4-fcce-4551-a83a-7d99c9bbd889-attachment.txt", "type": "text/plain"}, {"name": "Response Details", "source": "94f797df-fabb-4436-a4b6-aa2ace92a8b3-attachment.txt", "type": "text/plain"}], "start": 1752689495416, "stop": 1752689495849}], "start": 1752689495089, "stop": 1752689495851, "uuid": "8a75808b-04fd-48b4-ba97-720ae30c5190", "historyId": "ec96c6775d2e586c4c8170c792c1d99c", "testCaseId": "ec96c6775d2e586c4c8170c792c1d99c", "fullName": "tests.user.test_user_update#test_update_user", "labels": [{"name": "parentSuite", "value": "tests.user"}, {"name": "suite", "value": "test_user_update"}, {"name": "host", "value": "Lapochka"}, {"name": "thread", "value": "26756-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "tests.user.test_user_update"}]}